<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SENIMSU Water AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(135deg, #b3e5fc, #0288d1);
    min-height: 100vh;
    overflow: hidden;
  }

  /* ANIMATED WATER BOTTLE WITH CHARACTER - ENHANCED ANIMATION */
  .bottle-container {
    position: fixed;
    width: 300px;
    height: 600px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 0;
    pointer-events: none;
    animation: float 6s ease-in-out infinite;
  }

  @keyframes float {
    0%, 100% { transform: translate(-50%, -50%) translateY(0); }
    50% { transform: translate(-50%, -50%) translateY(-20px); }
  }

  .bottle {
    position: absolute;
    width: 200px;
    height: 450px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 60px 60px 50px 50px;
    bottom: 50px;
    left: 50%;
    transform: translateX(-50%);
    backdrop-filter: blur(15px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  }

  .water {
    position: absolute;
    bottom: 0;
    width: 200px;
    height: 380px;
    background: linear-gradient(180deg, #81d4fa, #029be5);
    border-radius: 60px 60px 50px 50px;
    animation: wave 7s ease-in-out infinite;
    overflow: hidden;
  }

  @keyframes wave {
    0%, 100% { height: 380px; transform: translateY(0); }
    50% { height: 400px; transform: translateY(-10px); }
  }

  .bottle::before {
    content: "";
    position: absolute;
    top: -50px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 60px;
    background: rgba(255, 255, 255, 0.4);
    border-radius: 25px 25px 15px 15px;
  }

  .eyes {
    position: absolute;
    top: 140px;
    width: 100%;
    text-align: center;
  }

  .eye {
    display: inline-block;
    width: 25px;
    height: 35px;
    background: #333;
    border-radius: 50%;
    margin: 0 35px;
    animation: blink 5s infinite;
  }

  @keyframes blink {
    0%, 90%, 100% { height: 35px; }
    95% { height: 5px; }
  }

  .mouth {
    position: absolute;
    top: 200px;
    left: 50%;
    transform: translateX(-50%);
    width: 70px;
    height: 35px;
    border-bottom: 10px solid #333;
    border-radius: 50%;
    animation: smile 4s ease-in-out infinite;
  }

  @keyframes smile {
    0%, 100% { width: 70px; }
    50% { width: 90px; }
  }

  /* MAIN CARD - IMPROVED RESPONSIVE DESIGN */
  .card {
    background: white;
    width: 90%;
    max-width: 500px;
    height: 90vh;
    margin: 5vh auto;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0,0,0,0.3);
    display: flex;
    flex-direction: column;
    z-index: 1;
    position: relative;
    overflow: hidden;
  }

  @media (max-width: 480px) {
    .card {
      width: 100%;
      height: 100vh;
      margin: 0;
      border-radius: 0;
    }
  }

  /* TOP NAVIGATION BAR - ENHANCED WITH HOVER EFFECTS */
  .top-nav {
    background: rgba(255, 255, 255, 0.95);
    padding: 15px 20px;
    border-bottom: 1px solid #e1f5fe;
    display: flex;
    justify-content: space-between;
    align-items: center;
    border-radius: 20px 20px 0 0;
    backdrop-filter: blur(10px);
    position: sticky;
    top: 0;
    z-index: 2;
  }

  .logo {
    font-size: 28px;
    font-weight: bold;
    color: #0277bd;
    cursor: pointer;
    transition: color 0.3s;
  }

  .logo:hover {
    color: #01579b;
  }

  .nav-links {
    display: flex;
    gap: 20px;
  }

  .nav-link {
    color: #01579b;
    font-size: 16px;
    cursor: pointer;
    padding: 8px 12px;
    border-radius: 8px;
    transition: all 0.3s;
    position: relative;
  }

  .nav-link::after {
    content: '';
    position: absolute;
    bottom: -2px;
    left: 0;
    width: 100%;
    height: 2px;
    background: #0288d1;
    transform: scaleX(0);
    transition: transform 0.3s;
  }

  .nav-link:hover::after {
    transform: scaleX(1);
  }

  .nav-link:hover {
    background: #e1f5fe;
  }

  .nav-link.active {
    background: #0288d1;
    color: white;
    font-weight: bold;
  }

  .nav-link.active::after {
    transform: scaleX(0);
  }

  /* CONTENT AREA - IMPROVED SCROLLING */
  .content {
    flex: 1;
    padding: 30px;
    overflow-y: auto;
    scrollbar-width: thin;
  }

  .content::-webkit-scrollbar {
    width: 8px;
  }

  .content::-webkit-scrollbar-thumb {
    background: #0288d1;
    border-radius: 10px;
  }

  h2 {
    color: #0277bd;
    margin-top: 0;
  }

  p {
    color: #555;
    font-size: 16px;
    margin-bottom: 25px;
  }

  .source-buttons {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
    gap: 12px;
    margin: 25px 0;
  }

  .source-btn {
    padding: 14px;
    background: #e1f5fe;
    color: #01579b;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 15px;
    transition: all 0.3s;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }

  .source-btn:hover {
    background: #b3e5fc;
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(2,136,209,0.3);
  }

  .source-btn.active {
    background: #0288d1;
    color: white;
    box-shadow: 0 5px 15px rgba(2,136,209,0.4);
    transform: translateY(-3px);
  }

  input {
    width: 90%;
    padding: 15px;
    font-size: 17px;
    border-radius: 10px;
    border: 2px solid #ccc;
    margin: 15px 0;
    transition: all 0.3s;
  }

  input:focus {
    border-color: #0288d1;
    outline: none;
    box-shadow: 0 0 10px rgba(2,136,209,0.2);
  }

  button.primary {
    padding: 16px;
    width: 100%;
    background: #0288d1;
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
    transition: all 0.3s;
    box-shadow: 0 5px 15px rgba(2,136,209,0.3);
  }

  button.primary:hover {
    background: #0277bd;
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(2,136,209,0.4);
  }

  .result {
    padding: 20px;
    border-radius: 12px;
    background: #e1f5fe;
    color: #01579b;
    font-size: 16px;
    line-height: 1.7;
    display: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  #chart-container {
    margin-top: 20px;
    padding: 10px;
    background: white;
    border-radius: 12px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .refilter-section {
    padding: 20px;
    background: #fff3e0;
    border-radius: 12px;
    border-left: 6px solid #ff9800;
    margin-top: 25px;
    display: none;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  .auth-form input {
    width: 90%;
    padding: 15px;
    margin: 10px 0;
    border-radius: 10px;
    border: 2px solid #ccc;
    transition: all 0.3s;
  }

  .auth-form input:focus {
    border-color: #0288d1;
    box-shadow: 0 0 10px rgba(2,136,209,0.2);
  }

  .history-list {
    text-align: left;
    margin-top: 20px;
  }

  .history-item {
    background: #e1f5fe;
    padding: 15px;
    margin: 15px 0;
    border-radius: 12px;
    font-size: 14px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    transition: transform 0.3s;
  }

  .history-item:hover {
    transform: translateY(-5px);
  }

  .clear-history {
    background: #ff5722;
    margin-top: 20px;
    box-shadow: 0 5px 15px rgba(255,87,34,0.3);
  }

  .clear-history:hover {
    background: #f4511e;
    box-shadow: 0 8px 20px rgba(255,87,34,0.4);
  }

  .footer {
    text-align: center;
    padding: 20px;
    font-size: 12px;
    color: #777;
    border-top: 1px solid #eee;
    margin-top: auto;
    background: white;
  }

  .footer a {
    color: #0288d1;
    text-decoration: none;
    margin: 0 10px;
    cursor: pointer;
  }

  .footer a:hover {
    text-decoration: underline;
  }

  .section {
    display: none;
  }

  .section.active {
    display: block;
  }

  /* Add tooltips for help */
  [data-tooltip] {
    position: relative;
  }

  [data-tooltip]::after {
    content: attr(data-tooltip);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: white;
    padding: 5px 10px;
    border-radius: 5px;
    white-space: nowrap;
    opacity: 0;
    transition: opacity 0.3s;
    pointer-events: none;
  }

  [data-tooltip]:hover::after {
    opacity: 1;
  }
</style>
</head>
<body>

<div class="bottle-container">
  <div class="bottle">
    <div class="water"></div>
    <div class="eyes">
      <div class="eye"></div>
      <div class="eye"></div>
    </div>
    <div class="mouth"></div>
  </div>
</div>

<div class="card">
  <!-- Top Navigation Bar -->
  <div class="top-nav">
    <div class="logo" onclick="showSection('analyze')">SENIMSU</div>
    <div class="nav-links">
      <div class="nav-link active" onclick="showSection('analyze')">Analyze</div>
      <div class="nav-link" onclick="showSection('profile')" id="profileLink">Profile</div>
      <div class="nav-link" onclick="showSection('auth')" id="authLink">Login</div>
      <div class="nav-link" onclick="logout()" id="logoutLink" style="display:none;">Logout</div>
    </div>
  </div>

  <!-- Scrollable Content -->
  <div class="content">
    <!-- Analyze Section -->
    <div id="analyze" class="section active">
      <p style="margin-top:0;">AI-Assisted Water Quality Analyzer <span data-tooltip="Enter turbidity and select source for simulation">‚ÑπÔ∏è</span></p>

      <div class="source-buttons">
        <button class="source-btn" onclick="selectSource('clean_snow', this)" data-tooltip="Low turbidity, high removal">Clean Snow<br><small>(Very low contaminants)</small></button>
        <button class="source-btn" onclick="selectSource('urban_snow', this)" data-tooltip="High pollutants, lower removal">Urban Snow<br><small>(High pollutants)</small></button>
        <button class="source-btn" onclick="selectSource('ice', this)" data-tooltip="Mineral-rich, good removal">Ice<br><small>(Mineral-rich)</small></button>
        <button class="source-btn" onclick="selectSource('sleet', this)" data-tooltip="Mixed, medium removal">Sleet<br><small>(Mixed precipitation)</small></button>
      </div>

      <p><strong>Selected source:</strong> <span id="selected">None yet</span></p>

      <input type="number" min="0" id="before" placeholder="Enter measured turbidity (NTU)" data-tooltip="NTU value before filtration">

      <button class="primary" onclick="analyze()">Analyze with Biochar Filter</button>

      <div id="output" class="result"></div>

      <div id="chart-container" style="display:none;">
        <canvas id="turbidityChart"></canvas>
      </div>

      <div id="refilter" class="refilter-section">
        <strong>üîÑ Re-filtration Recommended</strong><br><br>
        The predicted turbidity is still above safe drinking levels.<br>
        Please pass the water through the biochar filter again, then measure and enter the new NTU value.
      </div>
    </div>

    <!-- Profile Section -->
    <div id="profile" class="section">
      <h2>Your Profile</h2>
      <p>Welcome, <strong id="usernameDisplay">Guest</strong>!</p>
      <h3>Past Analyses</h3>
      <div id="history" class="history-list">
        <p>No analyses yet. Start analyzing water!</p>
      </div>
      <button class="primary clear-history" onclick="clearHistory()" id="clearBtn" style="display:none;">Clear History</button>
    </div>

    <!-- Auth Section -->
    <div id="auth" class="section">
      <div id="loginForm" class="auth-form">
        <h2>Login</h2>
        <input type="text" id="loginUser" placeholder="Username">
        <input type="password" id="loginPass" placeholder="Password">
        <button class="primary" onclick="login()">Login</button>
        <p style="margin-top:15px;">No account? <a href="#" onclick="showSignup()">Sign Up</a></p>
      </div>

      <div id="signupForm" class="auth-form" style="display:none;">
        <h2>Sign Up</h2>
        <input type="text" id="signupUser" placeholder="Username">
        <input type="password" id="signupPass" placeholder="Password">
        <button class="primary" onclick="signup()">Create Account</button>
        <p style="margin-top:15px;">Already have an account? <a href="#" onclick="showLogin()">Login</a></p>
      </div>
    </div>

    <!-- About Section -->
    <div id="about" class="section">
      <h2>About SENIMSU</h2>
      <p>SENIMSU Water AI is an innovative tool designed to simulate water quality analysis using biochar filtration. It helps users estimate turbidity reduction for various winter water sources like snow, ice, and sleet. Built with cutting-edge AI, it provides quick insights for safe water consumption in harsh environments. Our mission is to make water purification accessible and educational for everyone.</p>
      <p>Developed in 2026, SENIMSU combines scientific research on biochar efficiency with user-friendly design to promote sustainable water practices.</p>
    </div>

    <!-- Privacy Section -->
    <div id="privacy" class="section">
      <h2>Privacy Policy</h2>
      <p>At SENIMSU Water AI, we value your privacy. We collect minimal data, such as usernames and analysis history, stored locally in your browser via localStorage. No personal information is shared with third parties. We do not track your usage or sell data. By using this site, you agree to our terms. For questions, contact us.</p>
      <p>This policy was last updated on January 03, 2026.</p>
    </div>

    <!-- Contact Section -->
    <div id="contact" class="section">
      <h2>Contact Us</h2>
      <p>If you have questions, feedback, or need support, reach out via:</p>
      <p><strong>Email:</strong> shyn.aityk@gmail.com</p>
      <p><strong>Phone:</strong> +77753648452</p>
      <p>We aim to respond within 24-48 hours.</p>
    </div>
  </div>

  <!-- Enhanced Footer with Links -->
  <div class="footer">
    Simulation based on scientific studies of biochar filtration efficiency.<br>
    Different water sources have different contaminant types ‚Üí different removal rates.<br>
    Cute open bottle character by SENIMSU Water AI üåä<br>
    <a onclick="showSection('about')">About</a> | <a onclick="showSection('privacy')">Privacy</a> | <a onclick="showSection('contact')">Contact</a>
  </div>
</div>

<script>
let currentSource = '';
let currentUser = null;
let history = [];
let turbidityChart;

// Load saved data
function loadData() {
  const savedUser = localStorage.getItem('senimsuUser');
  if (savedUser) {
    currentUser = savedUser;
    updateUI();
  }
  const savedHistory = localStorage.getItem('senimsuHistory');
  if (savedHistory) {
    history = JSON.parse(savedHistory);
    if (currentUser) renderHistory();
  }
}
loadData();

function updateUI() {
  document.getElementById('usernameDisplay').textContent = currentUser || 'Guest';
  if (currentUser) {
    document.getElementById('logoutLink').style.display = 'block';
    document.getElementById('authLink').style.display = 'none';
    document.getElementById('profileLink').style.display = 'block';
  } else {
    document.getElementById('logoutLink').style.display = 'none';
    document.getElementById('authLink').style.display = 'block';
    document.getElementById('authLink').textContent = 'Login';
    document.getElementById('profileLink').style.display = 'none';
  }
}

function showSection(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');

  document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
  const activeLink = Array.from(document.querySelectorAll('.nav-link')).find(l => l.getAttribute('onclick') === `showSection('${id}')`);
  if (activeLink) activeLink.classList.add('active');
  if (id === 'auth' && currentUser) showSection('analyze');
}

function showLogin() {
  document.getElementById('loginForm').style.display = 'block';
  document.getElementById('signupForm').style.display = 'none';
}

function showSignup() {
  document.getElementById('loginForm').style.display = 'none';
  document.getElementById('signupForm').style.display = 'block';
}

function signup() {
  const user = document.getElementById('signupUser').value.trim();
  const pass = document.getElementById('signupPass').value;
  if (!user || !pass) return alert('Please fill all fields');
  if (localStorage.getItem('senimsu_' + user)) return alert('Username already taken');
  localStorage.setItem('senimsu_' + user, pass);
  alert('Account created! Now login.');
  showLogin();
}

function login() {
  const user = document.getElementById('loginUser').value.trim();
  const pass = document.getElementById('loginPass').value;
  if (!user || !pass) return alert('Please fill all fields');
  const savedPass = localStorage.getItem('senimsu_' + user);
  if (savedPass && savedPass === pass) {
    currentUser = user;
    localStorage.setItem('senimsuUser', user);
    updateUI();
    showSection('analyze');
    alert('Welcome back, ' + user + '!');
  } else {
    alert('Incorrect username or password');
  }
}

function logout() {
  if (confirm('Logout?')) {
    currentUser = null;
    localStorage.removeItem('senimsuUser');
    updateUI();
    showSection('analyze');
  }
}

function selectSource(source, button) {
  document.querySelectorAll('.source-btn').forEach(btn => btn.classList.remove('active'));
  button.classList.add('active');

  const names = {
    clean_snow: "Clean Snow",
    urban_snow: "Urban Snow",
    ice: "Ice",
    sleet: "Sleet"
  };
  document.getElementById('selected').textContent = names[source];
  currentSource = source;
  document.getElementById('before').focus();
}

function analyze() {
  if (!currentSource) return alert("Please select a water source first!");

  let before = parseFloat(document.getElementById("before").value);
  if (isNaN(before) || before < 0) return alert("Please enter a valid positive turbidity value (NTU).");

  let removalRate, explanation = "";

  switch (currentSource) {
    case 'clean_snow':
      removalRate = before <= 20 ? 98 : before <= 100 ? 95 : 92;
      explanation = "Clean snow has mostly fine suspended particles ‚Äî biochar removes 92-98% efficiently.";
      break;
    case 'urban_snow':
      removalRate = before <= 200 ? 82 : before <= 500 ? 78 : 72;
      explanation = "Urban snow contains heavy metals, oils, and road salt ‚Äî lower efficiency (72-82%).";
      break;
    case 'ice':
      removalRate = before <= 30 ? 94 : before <= 150 ? 90 : 85;
      explanation = "Ice often has mineral particles ‚Äî biochar achieves 85-94% reduction.";
      break;
    case 'sleet':
      removalRate = before <= 80 ? 90 : before <= 200 ? 85 : 80;
      explanation = "Sleet carries mixed contaminants ‚Äî 80-90% removal.";
      break;
  }

  let after = Math.round(before * (1 - removalRate / 100));
  let status = after <= 100 ? "Clean & Safe" : "Still Cloudy";
  let action = after <= 100 ? "Ready to boil and drink! ‚úÖ" : "Re-filter recommended";

  const resultHTML = `
    <strong>Source:</strong> ${document.getElementById('selected').textContent}<br>
    <strong>Initial turbidity:</strong> ${before} NTU<br>
    <strong>Predicted after filtration:</strong> ${after} NTU<br>
    <strong>Removal efficiency:</strong> ${removalRate}%<br><br>
    <em>${explanation}</em><br><br>
    <strong>Status:</strong> ${status}<br>
    <strong>Next step:</strong> ${action}
  `;

  document.getElementById("output").style.display = "block";
  document.getElementById("output").innerHTML = resultHTML;
  document.getElementById("refilter").style.display = after > 100 ? "block" : "none";

  // Render chart
  document.getElementById('chart-container').style.display = 'block';
  const ctx = document.getElementById('turbidityChart').getContext('2d');
  if (turbidityChart) turbidityChart.destroy();
  turbidityChart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels: ['Initial', 'Predicted'],
      datasets: [{
        label: 'Turbidity (NTU)',
        data: [before, after],
        backgroundColor: ['#0288d1', '#81d4fa'],
        borderColor: ['#0277bd', '#029be5'],
        borderWidth: 1
      }]
    },
    options: {
      scales: {
        y: {
          beginAtZero: true
        }
      },
      responsive: true,
      plugins: {
        legend: {
          display: false
        }
      }
    }
  });

  if (currentUser) {
    const entry = {
      date: new Date().toLocaleString(),
      source: document.getElementById('selected').textContent,
      initial: before,
      predicted: after,
      removal: removalRate
    };
    history.unshift(entry);
    localStorage.setItem('senimsuHistory', JSON.stringify(history));
    renderHistory();
  }
}

function renderHistory() {
  const container = document.getElementById('history');
  if (history.length === 0) {
    container.innerHTML = '<p>No analyses yet. Start analyzing water!</p>';
    document.getElementById('clearBtn').style.display = 'none';
    return;
  }
  container.innerHTML = '';
  history.forEach(item => {
    const div = document.createElement('div');
    div.className = 'history-item';
    div.innerHTML = `
      <strong>${item.date}</strong><br>
      Source: ${item.source}<br>
      Initial: ${item.initial} NTU ‚Üí Predicted: ${item.predicted} NTU (${item.removal}% removal)
    `;
    container.appendChild(div);
  });
  document.getElementById('clearBtn').style.display = 'block';
}

function clearHistory() {
  if (confirm('Clear all past analyses?')) {
    history = [];
    localStorage.removeItem('senimsuHistory');
    renderHistory();
  }
}
</script>

</body>
</html>
