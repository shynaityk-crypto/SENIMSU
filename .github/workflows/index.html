<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SENIMSU Water AI</title>
<style>
  body {
    margin: 0;
    font-family: "Segoe UI", Arial, sans-serif;
    background: linear-gradient(135deg, #b3e5fc, #0288d1);
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden;
  }

  /* ANIMATED WATER BOTTLE WITH CHARACTER - CAP REMOVED, FIXED POSITIONING */
  .bottle-container {
    position: fixed;
    width: 300px;
    height: 600px;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    z-index: 0;
    pointer-events: none;
  }

  .bottle {
    position: absolute;
    width: 200px;
    height: 450px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 60px 60px 50px 50px;
    bottom: 50px;
    left: 50%;
    transform: translateX(-50%);
    backdrop-filter: blur(15px);
    box-shadow: 0 20px 40px rgba(0,0,0,0.2);
  }

  .water {
    position: absolute;
    bottom: 0;
    width: 200px;
    height: 380px;
    background: linear-gradient(180deg, #81d4fa, #029be5);
    border-radius: 60px 60px 50px 50px;
    animation: wave 7s ease-in-out infinite;
    overflow: hidden;
  }

  @keyframes wave {
    0%, 100% { height: 380px; }
    50% { height: 400px; }
  }

  /* Open neck */
  .bottle::before {
    content: "";
    position: absolute;
    top: -50px;
    left: 50%;
    transform: translateX(-50%);
    width: 80px;
    height: 60px;
    background: rgba(255, 255, 255, 0.4);
    border-radius: 25px 25px 15px 15px;
  }

  .eyes {
    position: absolute;
    top: 140px;
    width: 100%;
    text-align: center;
  }

  .eye {
    display: inline-block;
    width: 25px;
    height: 35px;
    background: #333;
    border-radius: 50%;
    margin: 0 35px;
    animation: blink 5s infinite;
  }

  @keyframes blink {
    0%, 90%, 100% { height: 35px; }
    95% { height: 5px; }
  }

  .mouth {
    position: absolute;
    top: 200px;
    left: 50%;
    transform: translateX(-50%);
    width: 70px;
    height: 35px;
    border-bottom: 10px solid #333;
    border-radius: 50%;
  }

  /* MAIN CARD - NOW SCROLLABLE IF NEEDED */
  .card {
    background: white;
    width: 420px;
    max-width: 90%;
    padding: 35px 30px;
    border-radius: 20px;
    box-shadow: 0 15px 50px rgba(0,0,0,0.3);
    text-align: center;
    position: relative;
    z-index: 1;
    max-height: 90vh;
    overflow-y: auto;
    scrollbar-width: thin;
  }

  .card::-webkit-scrollbar {
    width: 8px;
  }

  .card::-webkit-scrollbar-thumb {
    background: #0288d1;
    border-radius: 10px;
  }

  h1 {
    color: #0277bd;
    margin-bottom: 10px;
    font-size: 32px;
    position: sticky;
    top: 0;
    background: white;
    padding: 10px 0;
    z-index: 2;
  }

  p {
    color: #555;
    font-size: 16px;
    margin-bottom: 25px;
  }

  .source-buttons {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 25px;
  }

  .source-btn {
    padding: 14px;
    background: #e1f5fe;
    color: #01579b;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 15px;
    transition: all 0.3s;
  }

  .source-btn:hover {
    background: #b3e5fc;
    transform: translateY(-2px);
  }

  .source-btn.active {
    background: #0288d1;
    color: white;
    box-shadow: 0 5px 15px rgba(2,136,209,0.4);
  }

  input {
    width: 90%;
    padding: 15px;
    font-size: 17px;
    border-radius: 10px;
    border: 2px solid #ccc;
    margin: 15px 0;
    transition: border 0.3s;
  }

  input:focus {
    border-color: #0288d1;
    outline: none;
  }

  button.primary {
    margin: 20px 0;
    padding: 16px;
    width: 100%;
    background: #0288d1;
    color: white;
    border: none;
    border-radius: 10px;
    font-size: 18px;
    cursor: pointer;
    transition: background 0.3s;
  }

  button.primary:hover {
    background: #0277bd;
  }

  .result {
    margin-top: 25px;
    padding: 20px;
    border-radius: 12px;
    background: #e1f5fe;
    color: #01579b;
    font-size: 16px;
    line-height: 1.7;
    display: none;
  }

  .refilter-section {
    margin-top: 25px;
    padding: 20px;
    background: #fff3e0;
    border-radius: 12px;
    border-left: 6px solid #ff9800;
    display: none;
  }

  .footer {
    margin-top: 30px;
    font-size: 12px;
    color: #777;
  }
</style>
</head>
<body>

<div class="bottle-container">
  <div class="bottle">
    <div class="water"></div>
    <div class="eyes">
      <div class="eye"></div>
      <div class="eye"></div>
    </div>
    <div class="mouth"></div>
  </div>
</div>

<div class="card">
  <h1>SENIMSU</h1>
  <p>AIâ€‘Assisted Water Quality Analyzer</p>

  <div class="source-buttons">
    <button class="source-btn" onclick="selectSource('clean_snow', this)">Clean Snow<br><small>(Very low contaminants)</small></button>
    <button class="source-btn" onclick="selectSource('urban_snow', this)">Urban Snow<br><small>(High pollutants)</small></button>
    <button class="source-btn" onclick="selectSource('ice', this)">Ice<br><small>(Mineral-rich)</small></button>
    <button class="source-btn" onclick="selectSource('sleet', this)">Sleet<br><small>(Mixed precipitation)</small></button>
  </div>

  <p><strong>Selected source:</strong> <span id="selected">None yet</span></p>

  <input type="number" min="0" id="before" placeholder="Enter measured turbidity (NTU)">

  <button class="primary" onclick="analyze()">Analyze with Biochar Filter</button>

  <div id="output" class="result"></div>

  <div id="refilter" class="refilter-section">
    <strong>ðŸ”„ Re-filtration Recommended</strong><br><br>
    The predicted turbidity is still above safe drinking levels.<br>
    Please pass the water through the biochar filter again, then measure and enter the new NTU value.
  </div>

  <div class="footer">
    Simulation based on scientific studies of biochar filtration efficiency.<br>
    Different water sources have different contaminant types â†’ different removal rates.<br>
    Cute open bottle character by SENIMSU Water AI ðŸŒŠ
  </div>
</div>

<script>
let currentSource = '';

function selectSource(source, button) {
  document.querySelectorAll('.source-btn').forEach(btn => btn.classList.remove('active'));
  button.classList.add('active');

  const names = {
    clean_snow: "Clean Snow",
    urban_snow: "Urban Snow",
    ice: "Ice",
    sleet: "Sleet"
  };
  document.getElementById('selected').textContent = names[source];
  currentSource = source;

  document.getElementById('before').focus();
}

function analyze() {
  if (!currentSource) {
    alert("Please select a water source first!");
    return;
  }

  let before = parseFloat(document.getElementById("before").value);
 
  if (isNaN(before) || before < 0) {
    alert("Please enter a valid positive turbidity value (NTU).");
    return;
  }

  let removalRate;
  let explanation = "";

  switch (currentSource) {
    case 'clean_snow':
      removalRate = before <= 20 ? 98 : before <= 100 ? 95 : 92;
      explanation = "Clean snow has mostly fine suspended particles â€” biochar removes 92-98% efficiently.";
      break;

    case 'urban_snow':
      removalRate = before <= 200 ? 82 : before <= 500 ? 78 : 72;
      explanation = "Urban snow contains heavy metals, oils, and road salt â€” biochar removal is lower (72-82%).";
      break;

    case 'ice':
      removalRate = before <= 30 ? 94 : before <= 150 ? 90 : 85;
      explanation = "Ice often has mineral particles â€” biochar achieves 85-94% turbidity reduction.";
      break;

    case 'sleet':
      removalRate = before <= 80 ? 90 : before <= 200 ? 85 : 80;
      explanation = "Sleet carries mixed atmospheric and surface contaminants â€” 80-90% removal.";
      break;
  }

  let after = Math.round(before * (1 - removalRate / 100));
  let status = after <= 100 ? "Clean & Safe" : "Still Cloudy";
  let action = after <= 100 ? "Ready to boil and drink! âœ…" : "Re-filter recommended";

  document.getElementById("output").style.display = "block";
  document.getElementById("output").innerHTML =
    "<strong>Source:</strong> " + document.getElementById('selected').textContent + "<br>" +
    "<strong>Initial turbidity:</strong> " + before + " NTU<br>" +
    "<strong>Predicted after one biochar filtration:</strong> " + after + " NTU<br>" +
    "<strong>Removal efficiency:</strong> " + removalRate + "%<br><br>" +
    "<em>" + explanation + "</em><br><br>" +
    "<strong>Status:</strong> " + status + "<br>" +
    "<strong>Next step:</strong> " + action;

  document.getElementById("refilter").style.display = after > 100 ? "block" : "none";
}
</script>

</body>
</html>
